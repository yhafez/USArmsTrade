[{"/Users/yhafez/Desktop/usarms/src/index.js":"1","/Users/yhafez/Desktop/usarms/src/App.js":"2","/Users/yhafez/Desktop/usarms/src/utils/format.js":"3","/Users/yhafez/Desktop/usarms/src/components/Instructions/Instructions.js":"4","/Users/yhafez/Desktop/usarms/src/components/RegionChart/RegionChart.js":"5","/Users/yhafez/Desktop/usarms/src/components/Header/Header.js":"6","/Users/yhafez/Desktop/usarms/src/components/HeatMap/HeatMap.js":"7","/Users/yhafez/Desktop/usarms/src/reportWebVitals.js":"8"},{"size":500,"mtime":1607464714656,"results":"9","hashOfConfig":"10"},{"size":1105,"mtime":1607505793645,"results":"11","hashOfConfig":"10"},{"size":101,"mtime":1607504870411,"results":"12","hashOfConfig":"10"},{"size":1721,"mtime":1607506294283,"results":"13","hashOfConfig":"10"},{"size":2189,"mtime":1607508000169,"results":"14","hashOfConfig":"10"},{"size":191,"mtime":1607504870344,"results":"15","hashOfConfig":"10"},{"size":12024,"mtime":1607504870345,"results":"16","hashOfConfig":"10"},{"size":385,"mtime":1607505103646,"results":"17","hashOfConfig":"10"},{"filePath":"18","messages":"19","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"13c8d41",{"filePath":"20","messages":"21","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"22","messages":"23","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"24"},{"filePath":"25","messages":"26","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"27","messages":"28","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"29","messages":"30","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"24"},{"filePath":"31","messages":"32","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"33","usedDeprecatedRules":"24"},{"filePath":"34","messages":"35","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/yhafez/Desktop/usarms/src/index.js",[],"/Users/yhafez/Desktop/usarms/src/App.js",["36","37","38","39","40","41"],"/Users/yhafez/Desktop/usarms/src/utils/format.js",[],["42","43"],"/Users/yhafez/Desktop/usarms/src/components/Instructions/Instructions.js",["44"],"/Users/yhafez/Desktop/usarms/src/components/RegionChart/RegionChart.js",["45"],"/Users/yhafez/Desktop/usarms/src/components/Header/Header.js",[],"/Users/yhafez/Desktop/usarms/src/components/HeatMap/HeatMap.js",["46","47","48"],"import React, { Component } from \"react\";\nimport Datamap from \"datamaps/dist/datamaps.world.min.js\";\nimport d3 from \"d3\";\nimport \"../HeatMap/HeatMap.css\";\nimport worldJson from \"../../data/world.topo.json\";\nimport armsSalesTotals from \"../../data/arms_sales_totals.json\";\nimport * as Countries from \"i18n-iso-countries\";\nimport { formatNumber } from \"../../utils/format\";\n\n// Required configuration to convert country names to their three digit country codes\nCountries.registerLocale(require(\"i18n-iso-countries/langs/en.json\"));\n\nexport default class Heatmap extends Component {\n\n  componentDidMount() {\n    /*----------------------------------------------- Variables -----------------------------------------------*/\n\n    \n    const startYear = this.props.startYear;\n    const endYear = this.props.endYear;\n\n    const hasStartYear = Boolean(startYear);\n    const hasEndYear = Boolean(endYear);\n\n    // If a start and end date are specified in filter settings, store the range as a string to use as key and in to validate that a date range has been specified\n    let dateRangeString;\n    if(hasStartYear && hasEndYear) dateRangeString = `${startYear}-${endYear}`\n\n    // Tracks largest authorization and dollar amounts based on filter settings\n    let maxAuthorization = 0;\n    let maxDelivery = 0;\n\n    // Define selectedData based on filter settings; default to total\n    let selectedData;\n    dateRangeString\n        ? selectedData = dateRangeString\n        : hasStartYear\n            ? selectedData = startYear\n            : selectedData = \"total\"\n\n    /*----------------------------------------------- Dataset -----------------------------------------------*/\n    \n    \n    // Loop over dataset, remove trailing spaces from country names, and create object \"formattedData\" containing country name, total delivery amounts, and authorization amounts, and yearly delivery amounts, and authorization amounts\n    const formattedData = armsSalesTotals.reduce((dataSet, yearlySale) => {\n        \n      // TODO: Logs portions of data that aren't rendered on the map; need to figure out what to do with this\n      // if(Countries.getAlpha3Code(yearlySale.country.trim(), \"en\") === undefined) console.log(yearlySale.country.trim(), yearlySale.country.trim().length );\n\n      const countryCode = Countries.getAlpha3Code(yearlySale.country.trim(), \"en\");\n      const countryName = yearlySale.country.trim();\n      const year = yearlySale.year;\n\n      // Somaliland doesn't have a 3 letter country code as required by Datamaps, but appears in datamaps rendered globe, so assign it a custom 3 letter code\n      if (countryName === \"Somaliland\"){\n          dataSet[\"SML\"] = {\n              country: countryName,\n              total:{\n                  authorizations: JSON.parse(yearlySale.authorizations),\n                  deliveries: JSON.parse(yearlySale.deliveries),\n              },\n          };\n          if(!dateRangeString) adjustMaxValues(yearlySale);\n      }\n      // If country isn't yet stored in totalVals, identify its Alpha-3 code (for compatability with Datamaps) to use as key, and store object containing country name, authorization amount, and delivery amount; else, increment authorization and delivery amounts to yield total amounts across all years\n      else if (!dataSet[countryCode]){\n          \n          dataSet[countryCode] = {\n              country: countryName,\n              total:{\n                  countryCode,\n                  authorizations: JSON.parse(yearlySale.authorizations),\n                  deliveries: JSON.parse(yearlySale.deliveries),\n              },\n          };\n          if(!dateRangeString) adjustMaxValues(yearlySale);\n\n          // If year is not-empty, store authorization and delivery values for that year, else store them as $0\n          dataSet[countryCode][year] = {\n              authorizations: JSON.parse(yearlySale.authorizations),\n              deliveries: JSON.parse(yearlySale.deliveries),\n          }\n          \n      }\n      else{\n          dataSet[countryCode].total.authorizations += JSON.parse(yearlySale.authorizations);\n          dataSet[countryCode].total.deliveries += JSON.parse(yearlySale.deliveries);\n          if(!dateRangeString) adjustMaxValues(yearlySale);\n\n          \n              dataSet[countryCode][year] = {\n                  authorizations: JSON.parse(yearlySale.authorizations),\n                  deliveries: JSON.parse(yearlySale.deliveries),\n              }\n          \n      }\n      return dataSet;\n    }, {});\n          \n    // Fill in missing data with values of $0 for deliveries and amoutns\n    for (let country in formattedData){   \n\n        for( let year=1996; year <= 2020; ++year){\n            if(!formattedData[country][year]){\n                formattedData[country][year] = {\n                    authorizations: 0,\n                    deliveries: 0,\n                }\n            }\n        }\n    }\n\n    // If a date range is specified in the filter settings, check the first item to see if there is a stored total value for that date range in the dataset and, if not, calculate the totals for that date range and store/memoize them\n    if(dateRangeString){\n        \n        if(!formattedData[Object.keys(formattedData)[0]][dateRangeString]){\n\n            for (let year = startYear; year<=endYear; ++year){\n                for (let country in formattedData){\n                    \n                    if(!formattedData[country][dateRangeString]){\n                        formattedData[country][dateRangeString] = {\n                            authorizations: formattedData[country][year].authorizations,\n                            deliveries: formattedData[country][year].deliveries\n                        }\n                    }\n                    else{\n                        formattedData[country][dateRangeString].authorizations += formattedData[country][year].authorizations;\n                        formattedData[country][dateRangeString].authorizations += formattedData[country][year].deliveries;\n                        adjustMaxValues(formattedData[country][dateRangeString]);\n                    }\n                    \n                } \n            }\n        }\n    }\n\n\n    // Set color scale for both deliveries and authorizations\n    let paletteScaleDeliveries = d3.scale.linear()\n        .domain([0, maxDelivery])\n        .range([\"rgb(159, 142, 173)\", \"rgb(128, 0, 255)\"]);\n\n    let paletteScaleAuthorizations = d3.scale.linear()\n        .domain([0, maxAuthorization])\n        .range([\"rgb(159, 142, 173)\", \"rgb(128, 0, 255)\"]);\n\n    // Assign color weight to each country and fill in missing years in formattedData\n    // TODO: Weight is currently based off deliveries; should we make it a button to toggle between weighing by deliveries and alternatively weighing by authorizations?\n    \n    for (let country in formattedData) {\n        \n        if(formattedData[country][selectedData].deliveries === 0){\n            formattedData[country].fillColor = \"#aaaaaa\";\n        }\n        else{\n            formattedData[country].fillColor = paletteScaleDeliveries(\n                formattedData[country][selectedData].deliveries\n            );\n        }\n    }\n      \n      \n    /*----------------------------------------------- Helper Functions -----------------------------------------------*/\n\n\n    // Helper function to adjust value of maxAuthorization and maxDelivery if those values in the item being processed are larger than currently set value appropriately based on selected filters\n    function adjustMaxValues({ authorizations, deliveries }){\n        \n        // If a start date and end date are set, then maxAuthorization and maxDelivery are set to represent the values of the countries with the highest sum of authorization and delivery amounts in that date range\n        if(hasStartYear){\n            if (+authorizations > maxAuthorization) maxAuthorization = authorizations;\n            if (+deliveries > maxDelivery) maxDelivery = deliveries;\n        }\n        // If only a start date is set, then maxAuthorization and maxDelivery are set to represent the values of the countries with the highest authorization and delivery amounts for that year only\n        else if(hasStartYear){\n            if (+authorizations > maxAuthorization) maxAuthorization = authorizations;\n            if (+deliveries > maxDelivery) maxDelivery = deliveries;\n        }\n        // If no start date or end date are set, maxAuthorization and maxDelivery defaults to representing the values of the countries with the highest sum of authorization and delivery amounts across all years\n        else{\n            if (+authorizations > maxAuthorization) maxAuthorization = authorizations;\n            if (+deliveries > maxDelivery) maxDelivery = deliveries;\n        }\n    }\n    \n    console.table(formattedData);\n\n    /*----------------------------------------------- Datamaps Config -----------------------------------------------*/\n\n\n    // Creates and configures the world map and its styles, as well as popups on hover\n    const map = new Datamap({\n        element: document.getElementById('heat_map'),\n        scope: 'world',\n          //Default color if no fillColor is specified\n        fills: {defaultFill: 'rgb(170, 170, 170)'},\n        // Specifies formattedData as data source for popup data and populating weighted color\n        data: formattedData,\n        dataType: 'json',\n        geographyConfig: {\n            dataUrl: \"./world.topo.json\",\n            popupOnHover: true,\n            borderColor: '#000',\n            borderWidth: '0.5',\n            highlightOnHover: true,\n            highlightBorderWidth: 1.5,\n            highlightBorderColor: \"#03fc5a\",\n            // Matches highlight color to fill color, so color doesn't change on hover\n            highlightFillColor: function(geo) {\n                return geo['fillColor'] || 'rgb(170, 170, 170)';\n            }, \n            // Defines template of popup that appears when country is hovered over based on filter settings\n            popupTemplate: function (geo, data){\n                if(!data){ return; }\n                if(selectedData === \"total\"){\n                    return [\n                        '<div class=\"hoverinfo\">',\n                            '<strong>', geo.properties.name + \" (1996 - 2020)\",'</strong>',\n                            '<br>Authorizations: <strong>$', formatNumber(data.total.authorizations), '</strong>',\n                            '<br>Deliveries: <strong>$', formatNumber(data.total.deliveries), '</strong>',\n                        '</div>'].join('')\n                }\n                else if(selectedData === dateRangeString){\n                    return [\n                        '<div class=\"hoverinfo\">',\n                            '<strong>', geo.properties.name + \" (\" + startYear + \" - \" + endYear + \")\",'</strong>',\n                            '<br>Authorizations: <strong>$', formatNumber(data[dateRangeString].authorizations), '</strong>',\n                            '<br>Deliveries: <strong>$', formatNumber(data[dateRangeString].deliveries), '</strong>',\n                        '</div>'].join('')\n                }\n                else {\n                    return [\n                    '<div class=\"hoverinfo\">',\n                        '<strong>', geo.properties.name + \" (\" + startYear + \")\",'</strong>',\n                        '<br>Authorizations: <strong>$', formatNumber(data[startYear].authorizations), '</strong>',\n                        '<br>Deliveries: <strong>$', formatNumber(data[startYear].deliveries), '</strong>',\n                    '</div>'].join('')\n                }\n            }\n        },\n    });\n  }\n  \n  /*----------------------------------------------- Component Render -----------------------------------------------*/\n\n  // Creates div React component which is used by Datamaps above as the container for the map\n  render(){\n      return(\n          <div id=\"heat_map\" style={{\n              height: \"100%\",\n              width: \"100%\",\n          }}></div>\n      )\n  }\n\n\n}\n","/Users/yhafez/Desktop/usarms/src/reportWebVitals.js",[],{"ruleId":"49","severity":1,"message":"50","line":2,"column":8,"nodeType":"51","messageId":"52","endLine":2,"endColumn":12},{"ruleId":"49","severity":1,"message":"53","line":12,"column":24,"nodeType":"51","messageId":"52","endLine":12,"endColumn":39},{"ruleId":"49","severity":1,"message":"54","line":13,"column":21,"nodeType":"51","messageId":"52","endLine":13,"endColumn":33},{"ruleId":"49","severity":1,"message":"55","line":14,"column":19,"nodeType":"51","messageId":"52","endLine":14,"endColumn":29},{"ruleId":"49","severity":1,"message":"56","line":17,"column":10,"nodeType":"51","messageId":"52","endLine":17,"endColumn":17},{"ruleId":"49","severity":1,"message":"57","line":17,"column":19,"nodeType":"51","messageId":"52","endLine":17,"endColumn":29},{"ruleId":"58","replacedBy":"59"},{"ruleId":"60","replacedBy":"61"},{"ruleId":"62","severity":1,"message":"63","line":15,"column":105,"nodeType":"64","endLine":15,"endColumn":120},{"ruleId":"49","severity":1,"message":"65","line":3,"column":10,"nodeType":"51","messageId":"52","endLine":3,"endColumn":13},{"ruleId":"49","severity":1,"message":"66","line":5,"column":8,"nodeType":"51","messageId":"52","endLine":5,"endColumn":17},{"ruleId":"49","severity":1,"message":"67","line":144,"column":9,"nodeType":"51","messageId":"52","endLine":144,"endColumn":35},{"ruleId":"49","severity":1,"message":"68","line":193,"column":11,"nodeType":"51","messageId":"52","endLine":193,"endColumn":14},"no-unused-vars","'logo' is defined but never used.","Identifier","unusedVar","'setDisplayTotal' is assigned a value but never used.","'setStartYear' is assigned a value but never used.","'setEndYear' is assigned a value but never used.","'dataSet' is assigned a value but never used.","'setDataSet' is assigned a value but never used.","no-native-reassign",["69"],"no-negated-in-lhs",["70"],"react/jsx-no-target-blank","Using target=\"_blank\" without rel=\"noreferrer\" is a security risk: see https://html.spec.whatwg.org/multipage/links.html#link-type-noopener","JSXAttribute","'Pie' is defined but never used.","'worldJson' is defined but never used.","'paletteScaleAuthorizations' is assigned a value but never used.","'map' is assigned a value but never used.","no-global-assign","no-unsafe-negation"]